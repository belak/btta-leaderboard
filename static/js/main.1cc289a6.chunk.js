(this.webpackJsonpleaderboard=this.webpackJsonpleaderboard||[]).push([[0],{15:function(e,t,a){e.exports=a(34)},21:function(e,t,a){},34:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(13),o=a.n(c),s=(a(20),a(21),a(1)),i=a(14),u=a(7),l=a.n(u),d=a(4),f=a.n(d);function m(e,t){var a=Object(n.useRef)(e),r=Object(n.useState)(!1),c=Object(s.a)(r,2),o=c[0],i=c[1];return Object(n.useEffect)((function(){a.current=e}),[e]),Object(n.useEffect)((function(){var e=setInterval((function(){a.current()}),t);return function(){return clearTimeout(e)}}),[a,t,o]),Object(n.useCallback)((function(){return i(!o)}),[o,i])}function b(){var e="object"===typeof window;return{width:e?window.innerWidth:void 0,height:e?window.innerHeight:void 0}}function p(){var e=Object(n.useState)(b),t=Object(s.a)(e,2),a=t[0],r=t[1];return Object(n.useEffect)((function(){if("object"===typeof window)return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)};function e(){r(b())}}),[]),a}function g(e){return(e.width||0)<=1e3}function h(e){if(!(window.matchMedia&&(window.matchMedia("only screen and (min-resolution: 124dpi), only screen and (min-resolution: 1.3dppx), only screen and (min-resolution: 48.8dpcm)").matches||window.matchMedia("only screen and (-webkit-min-device-pixel-ratio: 1.3), only screen and (-o-min-device-pixel-ratio: 2.6/2), only screen and (min--moz-device-pixel-ratio: 1.3), only screen and (min-device-pixel-ratio: 1.3)").matches)||window.devicePixelRatio&&window.devicePixelRatio>1.3))return e;var t=e.split("."),a=t.pop(),n=t.join(".");return a?"".concat(n,"@2x.").concat(a):e}function v(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:9e3,r=Object(n.useCallback)((function(){t||e()}),[e,t]),c=m(r,a);Object(n.useEffect)((function(){var t=function(){e(),c()};return f.a.bind("space",t),f.a.bind("enter",t),f.a.bind("right",t),function(){f.a.unbind("space"),f.a.unbind("enter"),f.a.unbind("right")}}),[c,t,e])}var w=a(2),j=a.n(w),O=a(5),E=a(6),x=a(37),y=a(36),k=a(8),S=a.n(k),N=function(){var e=Object(O.a)(j.a.mark((function e(t){var a,n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(t,"/api/scores/"));case 3:if(200!==(a=e.sent).status){e.next=15;break}return e.t0=S.a,e.next=8,a.json();case 8:return e.t1=e.sent,e.t2={deep:!0},n=(0,e.t0)(e.t1,e.t2),r=new Date,e.abrupt("return",n.map((function(e){var t=Object(x.a)(e.modified),a=t>Object(x.a)(e.created)&&Object(y.a)(r,t)<2592e3;return Object(E.a)({},e,{gameBannerThumbnail:h(e.gameBannerThumbnail),newScore:a})})));case 15:return e.next=17,a.text();case 17:throw"Failed to get scores: "+e.sent;case 19:e.next=24;break;case 21:throw e.prev=21,e.t3=e.catch(0),"Failed to get scores: "+e.t3;case 24:case"end":return e.stop()}}),e,null,[[0,21]])})));return function(t){return e.apply(this,arguments)}}(),C=function(){var e=Object(O.a)(j.a.mark((function e(t){var a,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(t,"/api/images/"));case 3:if(200!==(a=e.sent).status){e.next=14;break}return e.t0=S.a,e.next=8,a.json();case 8:return e.t1=e.sent,e.t2={deep:!0},n=(0,e.t0)(e.t1,e.t2),e.abrupt("return",n);case 14:return e.next=16,a.text();case 16:throw"Failed to get scores: "+e.sent;case 18:e.next=23;break;case 20:throw e.prev=20,e.t3=e.catch(0),"Failed to get scores: "+e.t3;case 23:case"end":return e.stop()}}),e,null,[[0,20]])})));return function(t){return e.apply(this,arguments)}}(),I=r.a.createContext(void 0),L=function(e,t){switch(t.type){case"setImages":return Object(E.a)({},e,{error:void 0,images:t.payload});case"setScores":return Object(E.a)({},e,{error:void 0,scores:t.payload});case"setError":return Object(E.a)({},e,{error:t.payload});default:return e}},R={images:[],scores:[]},F=function(e){var t=function(e,t){var a=Object(n.useState)((function(){try{var a=window.localStorage.getItem(e);return a?JSON.parse(a):t}catch(n){return console.log(n),t}})),r=Object(s.a)(a,2),c=r[0],o=r[1];return[c,function(t){try{o(t),window.localStorage.setItem(e,JSON.stringify(t))}catch(a){console.log(a)}}]}("leaderboardUrl","https://btta-api.elwert.cloud"),a=Object(s.a)(t,2),c=a[0],o=a[1],i=Object(n.useReducer)(L,R),u=Object(s.a)(i,2),l=u[0],d=u[1],f=Object(n.useCallback)(Object(O.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C(c);case 3:t=e.sent,d({type:"setImages",payload:t}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),d({type:"setError",payload:e.t0.toString()});case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),[d,c]),m=Object(n.useCallback)(Object(O.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,N(c);case 3:t=e.sent,d({type:"setScores",payload:t}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),d({type:"setError",payload:e.t0.toString()});case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),[d,c]);return Object(n.useEffect)((function(){f(),m()}),[f,m]),r.a.createElement(I.Provider,{value:{state:l,baseURL:c,refreshImages:f,refreshScores:m,setBaseURL:o}},e.children)},B=function(){var e=r.a.useContext(I);if(void 0===e)throw new Error("useCountState must be used within a CountProvider");return e},P=function(e){var t=e.onFinished,a=e.onNextPage,c=e.paused,o=Object(n.useState)(0),i=Object(s.a)(o,2),u=i[0],d=i[1],f=Object(n.useState)(1),m=Object(s.a)(f,2),b=m[0],h=m[1],w=B().state.scores;Object(n.useEffect)((function(){0===w.length&&t(),w.map((function(e){var t=e.gameBannerThumbnail,a=new Image;return a.src=t,a}))}),[w,t]);var j=Object(n.useRef)(null);v(Object(n.useCallback)((function(){var e=u+b,n=e>=w.length?0:e;n!==u&&d(n),0===n?t():a()}),[u,b,w.length,d,t,a]),c);var O=p();return Object(n.useLayoutEffect)((function(){g(O)||h(1)}),[O,h]),Object(n.useLayoutEffect)((function(){var e;if(j.current)if((O.width||0)<1e3)h(w.length);else{var t=j.current.clientHeight,a=null===(e=j.current.firstChild)||void 0===e?void 0:e.firstChild;if(a){var n=Math.floor(t/(a.clientHeight+1));b!==n&&h(n)}}}),[b,h,j,w.length,O]),r.a.createElement("div",{className:"scoresContainer",ref:j},r.a.createElement("div",{className:"scores"},w.slice(u,u+b).map((function(e,t){return r.a.createElement(r.a.Fragment,{key:e.id},0!==t&&r.a.createElement("span",{className:"line"}),r.a.createElement("span",{className:l()("gameName",{newScore:e.newScore})},r.a.createElement("img",{src:e.gameBannerThumbnail,alt:e.gameName})),r.a.createElement("span",{className:l()("playerName",{newScore:e.newScore})},e.playerName),r.a.createElement("span",{className:l()("score",{newScore:e.newScore})},Number(e.playerScore).toLocaleString()))}))))},M=function(e){var t=e.onFinished,a=e.onNextPage,c=e.paused,o=e.page,s=B().state.images,i=g(p());Object(n.useEffect)((function(){i||s.map((function(e){var t=e.image,a=new Image;return a.src=t,a}))}),[s,i]);var u=s.length?o%s.length:0;Object(n.useEffect)((function(){s.length<=u&&t()}),[u,s.length,t]),v(a,c);var l=s[u];return r.a.createElement("div",{className:"imageContainer"},l&&r.a.createElement("img",{src:l.image,alt:l.name,className:"fullscreenImage"}))};var U=function(){var e=Object(n.useRef)(null),t=B(),a=t.state,c=t.baseURL,o=t.setBaseURL,u=t.refreshImages,l=t.refreshScores,d=Object(n.useState)(!1),f=Object(s.a)(d,2),m=f[0],b=f[1],h=Object(n.useState)("images"),v=Object(s.a)(h,2),w=v[0],j=v[1],O=Object(n.useState)(0),E=Object(s.a)(O,2),x=E[0],y=E[1],k=g(p()),S=Object(n.useCallback)((function(){b(!m)}),[m,b]);Object(n.useEffect)((function(){if("form"!==w)return Mousetrap.bind("p",S),function(){Mousetrap.unbind("p")}}),[S,w]);var N=Object(n.useCallback)((function(){switch(w){case"images":j("leaderboard"),y(x+1)}}),[j,w,x,y]),C=Object(n.useCallback)((function(){switch(w){case"form":j("leaderboard");break;case"leaderboard":j("images"),k||l();break;case"images":j("leaderboard"),y(0),k||u();break;default:j("leaderboard")}}),[j,w,u,l,y,k]),I=Object(n.useCallback)((function(){e.current&&o(e.current.value),j("leaderboard")}),[j,e,o]),L=Object(n.useCallback)((function(){j("form"),window.requestAnimationFrame((function(){if(!e.current)throw Error("couldn't get input ref");e.current.value=c}))}),[j,e,c]),R="form"===w,F=k?!R:"leaderboard"===w,U=k?!R:"images"===w,T=a.scores.length,J=a.images.length;return Object(n.useEffect)((function(){T!==J&&("leaderboard"!==w||T?"images"!==w||J||j("leaderboard"):j("images"))}),[T,J,j,w]),r.a.createElement("div",{className:"App"},r.a.createElement("header",{onClick:L},r.a.createElement("img",{className:"logo",src:"logo.png",alt:"Back to the Arcade"}),r.a.createElement("img",{className:"leaderboard",src:"leaderboard-text.png",alt:"Leaderboard"})),a.error&&r.a.createElement("div",null,r.a.createElement("h2",null,"Error:"),a.error),R&&r.a.createElement("form",{onSubmit:I},"URL: ",r.a.createElement("input",{name:"url",ref:e}),r.a.createElement("button",{type:"submit"},"Connect")),T&&F&&r.a.createElement(P,{onFinished:C,onNextPage:N,paused:m}),J&&U&&r.a.createElement(M,{onFinished:C,onNextPage:N,paused:m,page:x}),r.a.createElement("footer",null,r.a.createElement("img",{src:"pacman-ghosts.jpg",alt:""})),m&&r.a.createElement(i.a,{className:"playPause"}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(F,null,r.a.createElement(U,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[15,1,2]]]);
//# sourceMappingURL=main.1cc289a6.chunk.js.map